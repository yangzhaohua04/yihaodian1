!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=55)}([function(t,e){var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(27)("wks"),o=n(19),i=n(1).Symbol,u="function"==typeof i;(t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))}).store=r},function(t,e,n){var r=n(1),o=n(0),i=n(16),u=n(7),a=n(9),c=function(t,e,n){var s,f,l,h=t&c.F,p=t&c.G,d=t&c.S,v=t&c.P,g=t&c.B,m=t&c.W,y=p?o:o[e]||(o[e]={}),b=y.prototype,w=p?r:d?r[e]:(r[e]||{}).prototype;for(s in p&&(n=e),n)(f=!h&&w&&void 0!==w[s])&&a(y,s)||(l=f?w[s]:n[s],y[s]=p&&"function"!=typeof w[s]?n[s]:g&&f?i(l,r):m&&w[s]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):v&&"function"==typeof l?i(Function.call,l):l,v&&((y.virtual||(y.virtual={}))[s]=l,t&c.R&&b&&!b[s]&&u(b,s,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e,n){var r=n(5),o=n(36),i=n(23),u=Object.defineProperty;e.f=n(6)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return u(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(10)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(4),o=n(18);t.exports=n(6)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(38),o=n(24);t.exports=function(t){return r(o(t))}},function(t,e,n){var r=n(37),o=n(28);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=!0},function(t,e){t.exports={}},function(t,e,n){var r=n(17);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(4).f,o=n(9),i=n(2)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){var r=n(8),o=n(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,n){var r=n(8);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(27)("keys"),o=n(19);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e,n){var r=n(0),o=n(1),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(14)?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(24);t.exports=function(t){return Object(r(t))}},function(t,e,n){t.exports={default:n(66),__esModule:!0}},function(t,e,n){"use strict";var r=n(17);function o(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new o(t)}},function(t,e,n){e.f=n(2)},function(t,e,n){var r=n(1),o=n(0),i=n(14),u=n(33),a=n(4).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:u.f(t)})}},function(t,e,n){t.exports={default:n(56),__esModule:!0}},function(t,e,n){t.exports=!n(6)&&!n(10)(function(){return 7!=Object.defineProperty(n(22)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(9),o=n(11),i=n(61)(!1),u=n(26)("IE_PROTO");t.exports=function(t,e){var n,a=o(t),c=0,s=[];for(n in a)n!=u&&r(a,n)&&s.push(n);for(;e.length>c;)r(a,n=e[c++])&&(~i(s,n)||s.push(n));return s}},function(t,e,n){var r=n(13);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(25),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e){},function(t,e,n){"use strict";var r=n(67)(!0);n(42)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(14),o=n(3),i=n(43),u=n(7),a=n(15),c=n(68),s=n(21),f=n(70),l=n(2)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,d,v,g,m){c(n,e,d);var y,b,w,x=function(t){if(!h&&t in O)return O[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},_=e+" Iterator",S="values"==v,I=!1,O=t.prototype,j=O[l]||O["@@iterator"]||v&&O[v],E=j||x(v),L=v?S?x("entries"):E:void 0,T="Array"==e&&O.entries||j;if(T&&(w=f(T.call(new t)))!==Object.prototype&&w.next&&(s(w,_,!0),r||"function"==typeof w[l]||u(w,l,p)),S&&j&&"values"!==j.name&&(I=!0,E=function(){return j.call(this)}),r&&!m||!h&&!I&&O[l]||u(O,l,E),a[e]=E,a[_]=p,v)if(y={values:S?E:x("values"),keys:g?E:x("keys"),entries:L},m)for(b in y)b in O||i(O,b,y[b]);else o(o.P+o.F*(h||I),e,y);return y}},function(t,e,n){t.exports=n(7)},function(t,e,n){var r=n(5),o=n(69),i=n(28),u=n(26)("IE_PROTO"),a=function(){},c=function(){var t,e=n(22)("iframe"),r=i.length;for(e.style.display="none",n(45).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;r--;)delete c.prototype[i[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[u]=t):n=c(),void 0===e?n:o(n,e)}},function(t,e,n){var r=n(1).document;t.exports=r&&r.documentElement},function(t,e,n){n(71);for(var r=n(1),o=n(7),i=n(15),u=n(2)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var s=a[c],f=r[s],l=f&&f.prototype;l&&!l[u]&&o(l,u,s),i[s]=i.Array}},function(t,e,n){var r=n(13),o=n(2)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,u;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:i?r(e):"Object"==(u=r(e))&&"function"==typeof e.callee?"Arguments":u}},function(t,e,n){var r=n(5),o=n(17),i=n(2)("species");t.exports=function(t,e){var n,u=r(t).constructor;return void 0===u||null==(n=r(u)[i])?e:o(n)}},function(t,e,n){var r,o,i,u=n(16),a=n(80),c=n(45),s=n(22),f=n(1),l=f.process,h=f.setImmediate,p=f.clearImmediate,d=f.MessageChannel,v=f.Dispatch,g=0,m={},y=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},b=function(t){y.call(t.data)};h&&p||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++g]=function(){a("function"==typeof t?t:Function(t),e)},r(g),g},p=function(t){delete m[t]},"process"==n(13)(l)?r=function(t){l.nextTick(u(y,t,1))}:v&&v.now?r=function(t){v.now(u(y,t,1))}:d?(i=(o=new d).port2,o.port1.onmessage=b,r=u(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(t){f.postMessage(t+"","*")},f.addEventListener("message",b,!1)):r="onreadystatechange"in s("script")?function(t){c.appendChild(s("script")).onreadystatechange=function(){c.removeChild(this),y.call(t)}}:function(t){setTimeout(u(y,t,1),0)}),t.exports={set:h,clear:p}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(5),o=n(8),i=n(32);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var n=i.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var r,o,i,u,a;r=n(94),o=n(53).utf8,i=n(95),u=n(53).bin,(a=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?u.stringToBytes(t):o.stringToBytes(t):i(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var n=r.bytesToWords(t),c=8*t.length,s=1732584193,f=-271733879,l=-1732584194,h=271733878,p=0;p<n.length;p++)n[p]=16711935&(n[p]<<8|n[p]>>>24)|4278255360&(n[p]<<24|n[p]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var d=a._ff,v=a._gg,g=a._hh,m=a._ii;for(p=0;p<n.length;p+=16){var y=s,b=f,w=l,x=h;s=d(s,f,l,h,n[p+0],7,-680876936),h=d(h,s,f,l,n[p+1],12,-389564586),l=d(l,h,s,f,n[p+2],17,606105819),f=d(f,l,h,s,n[p+3],22,-1044525330),s=d(s,f,l,h,n[p+4],7,-176418897),h=d(h,s,f,l,n[p+5],12,1200080426),l=d(l,h,s,f,n[p+6],17,-1473231341),f=d(f,l,h,s,n[p+7],22,-45705983),s=d(s,f,l,h,n[p+8],7,1770035416),h=d(h,s,f,l,n[p+9],12,-1958414417),l=d(l,h,s,f,n[p+10],17,-42063),f=d(f,l,h,s,n[p+11],22,-1990404162),s=d(s,f,l,h,n[p+12],7,1804603682),h=d(h,s,f,l,n[p+13],12,-40341101),l=d(l,h,s,f,n[p+14],17,-1502002290),s=v(s,f=d(f,l,h,s,n[p+15],22,1236535329),l,h,n[p+1],5,-165796510),h=v(h,s,f,l,n[p+6],9,-1069501632),l=v(l,h,s,f,n[p+11],14,643717713),f=v(f,l,h,s,n[p+0],20,-373897302),s=v(s,f,l,h,n[p+5],5,-701558691),h=v(h,s,f,l,n[p+10],9,38016083),l=v(l,h,s,f,n[p+15],14,-660478335),f=v(f,l,h,s,n[p+4],20,-405537848),s=v(s,f,l,h,n[p+9],5,568446438),h=v(h,s,f,l,n[p+14],9,-1019803690),l=v(l,h,s,f,n[p+3],14,-187363961),f=v(f,l,h,s,n[p+8],20,1163531501),s=v(s,f,l,h,n[p+13],5,-1444681467),h=v(h,s,f,l,n[p+2],9,-51403784),l=v(l,h,s,f,n[p+7],14,1735328473),s=g(s,f=v(f,l,h,s,n[p+12],20,-1926607734),l,h,n[p+5],4,-378558),h=g(h,s,f,l,n[p+8],11,-2022574463),l=g(l,h,s,f,n[p+11],16,1839030562),f=g(f,l,h,s,n[p+14],23,-35309556),s=g(s,f,l,h,n[p+1],4,-1530992060),h=g(h,s,f,l,n[p+4],11,1272893353),l=g(l,h,s,f,n[p+7],16,-155497632),f=g(f,l,h,s,n[p+10],23,-1094730640),s=g(s,f,l,h,n[p+13],4,681279174),h=g(h,s,f,l,n[p+0],11,-358537222),l=g(l,h,s,f,n[p+3],16,-722521979),f=g(f,l,h,s,n[p+6],23,76029189),s=g(s,f,l,h,n[p+9],4,-640364487),h=g(h,s,f,l,n[p+12],11,-421815835),l=g(l,h,s,f,n[p+15],16,530742520),s=m(s,f=g(f,l,h,s,n[p+2],23,-995338651),l,h,n[p+0],6,-198630844),h=m(h,s,f,l,n[p+7],10,1126891415),l=m(l,h,s,f,n[p+14],15,-1416354905),f=m(f,l,h,s,n[p+5],21,-57434055),s=m(s,f,l,h,n[p+12],6,1700485571),h=m(h,s,f,l,n[p+3],10,-1894986606),l=m(l,h,s,f,n[p+10],15,-1051523),f=m(f,l,h,s,n[p+1],21,-2054922799),s=m(s,f,l,h,n[p+8],6,1873313359),h=m(h,s,f,l,n[p+15],10,-30611744),l=m(l,h,s,f,n[p+6],15,-1560198380),f=m(f,l,h,s,n[p+13],21,1309151649),s=m(s,f,l,h,n[p+4],6,-145523070),h=m(h,s,f,l,n[p+11],10,-1120210379),l=m(l,h,s,f,n[p+2],15,718787259),f=m(f,l,h,s,n[p+9],21,-343485551),s=s+y>>>0,f=f+b>>>0,l=l+w>>>0,h=h+x>>>0}return r.endian([s,f,l,h])})._ff=function(t,e,n,r,o,i,u){var a=t+(e&n|~e&r)+(o>>>0)+u;return(a<<i|a>>>32-i)+e},a._gg=function(t,e,n,r,o,i,u){var a=t+(e&r|n&~r)+(o>>>0)+u;return(a<<i|a>>>32-i)+e},a._hh=function(t,e,n,r,o,i,u){var a=t+(e^n^r)+(o>>>0)+u;return(a<<i|a>>>32-i)+e},a._ii=function(t,e,n,r,o,i,u){var a=t+(n^(e|~r))+(o>>>0)+u;return(a<<i|a>>>32-i)+e},a._blocksize=16,a._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var n=r.wordsToBytes(a(t,e));return e&&e.asBytes?n:e&&e.asString?u.bytesToString(n):r.bytesToHex(n)}},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e,n){var r=n(37),o=n(28).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=d(n(35)),i=d(n(57)),u=d(n(63)),a=d(n(31)),c=d(n(88)),s=d(n(89)),f=d(n(90)),l=d(n(52)),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(96)),p=d(n(114));function d(t){return t&&t.__esModule?t:{default:t}}e.default=(r=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.maxSize,o=void 0===r?2:r,i=n.channelId,u=void 0===i?"":i,a=n.userId,c=n.maxWidth,f=void 0===c?700:c,l=n.lang,d=void 0===l?"zh_CN":l,v=n.isChatRoom,g=void 0===v||v,m=n.limit,y=void 0===m?9:m,b=n.currentUploadNum,w=void 0===b?0:b,x=n.reUploadInterval,_=void 0===x?5e3:x,S=n.reUploadTimes,I=void 0===S?3:S,O=n.maxWidthForShow,j=void 0===O?696:O,E=n.maxHeightForShow,L=void 0===E?456:E,T=n.isCompareSize,M=void 0!==T&&T,P=n.bucket,F=void 0===P?"liveimages":P;if((0,s.default)(this,t),p.default[d]||(d="zh_CN"),this.lang=p.default[d],!e)throw new Error(this.lang.missingId);this.file="string"==typeof e?document.querySelector(e):e,this.subscriber=[],this.maxSize=o,this.channelId=u,this.userId=a,this.imgId=a||u,this.imgs={};var k=h.browserType(),A=k.isIE,N=k.version;A&&N<9&&this.file.setAttribute("style","display:none"),this.maxWidth=f,this.isChatRoom=g,this.bucket=F,this.limit=y,this.currentUploadNum=w,this.isUploading=!1,this.reUploadInterval=_,this.reUploadTimes=I,this.maxWidthForShow=j,this.maxHeightForShow=L,this.isCompareSize=M,this.subscript(this.getUploadStatus.bind(this)),this.listen()}return(0,f.default)(t,[{key:"getUploadStatus",value:function(t){if("start"!==t.status){var e=this.files.length;this.currentIndex<e-1&&this.currentUploadNum<this.limit-1?(this.currentIndex++,this.sendImg(this.files[this.currentIndex])):(this.file.value=null,this.isUploading=!1)}}},{key:"listen",value:function(){var t=this,e=h.browserType(),n=e.isIE,r=e.version;n&&9==r&&h.uploadImgForIE9Init(this.file),h.addHandler(this.file,"change",function(){t.file&&t.file.files&&(t.files=t.file.files),t.currentIndex=0,t.isUploading=!0,t.limit-t.currentUploadNum>0&&t.sendImg(t.files&&t.files[0])})}},{key:"sendImg",value:function(t){var e="chat_img_"+this.imgId+"_"+(new Date).getTime()+parseInt(10*Math.random());this.imgs[e]={fileData:t,resendTimes:0,timeout:null},this.size=null;var n=h.browserType(),r=n.isIE,o=n.version;r&&9==o?this.sendForIE9(e):this.addNewImg(e)}},{key:"addNewImg",value:function(){var t=(0,c.default)(u.default.mark(function t(e){var n,r,o,i,c,s,f,l,p,d,v,g,m,y,b=this,w=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.imgs[e],r=n.fileData,o=n.blob,r||o){t.next=3;break}return t.abrupt("return");case 3:if(c=(i=r||o).size,s=i.type,f=e+"."+(s.split("/")[1]||"png"),o||!w){t.next=25;break}if(h.isRightType(s)){t.next=9;break}return this.done({status:"fail",msg:this.lang.inCorrectFormat,id:e}),t.abrupt("return");case 9:if(!((l=c/Math.pow(10,6))>this.maxSize)){t.next=14;break}return p=h.browserType(),d=p.isIE,v=p.version,d&&v<=9||l>50?this.done({status:"fail",msg:this.lang.tooLarge,id:e}):this.compressImg(r,e,.7,f),t.abrupt("return");case 14:return t.next=16,new a.default(function(t){if(b.size)return t(!0);h.getImgSize(r).then(function(n){if(!n)return t(!1),console.warn("è·åå¾çå°ºå¯¸å¤±è´¥"),void b.addNewImg(e,!1);b.size=n,t(!0)})});case 16:if(t.sent){t.next=19;break}return t.abrupt("return");case 19:if(g=this.size,m=g.width,y=g.height,!(m>this.maxWidth)){t.next=23;break}return this.compressImg(r,e,1,f),t.abrupt("return");case 23:if(!this.isCompareSize||!(m<=y&&y*this.maxWidthForShow/m>=4096||m>y&&m*this.maxHeightForShow/y>=4096)){t.next=25;break}return t.abrupt("return",this.done({status:"fail",msg:this.lang.beyondSize,id:e}));case 25:this.size||(this.size={width:500,height:500}),document.querySelector("#"+e)||this.done({status:"start",msg:this.lang.startUpload,type:"chatImg",id:e,imgSrc:h.getLocalImg(r),size:this.size}),this.upload({fileData:r,blob:o,id:e,imgName:f});case 28:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"upload",value:function(t){var e=this,n=t.fileData,r=t.blob,o=t.id,u=t.imgName,a={status:"upLoadingFail",msg:this.lang.uploadFail,type:"chatImg",id:o,imgSrc:h.getLocalImg(n)};this.getUploadImgMsg().then(function(t){if(!t)return e.done(a);h.postImgData({data:t,imgName:u,fileData:n,blob:r}).then(function(t){if(!t)return e.done({status:"upLoadingFail",msg:e.lang.invalidImage,id:o});if(200!==t.code)return e.done(a);var n={};try{n=JSON.parse(t.data)}catch(t){console.warn(t)}var r="http:"+n.data,i=function(t,n){return e.done({status:t,msg:n,id:o,uploadImgUrl:r,type:"chatImg",size:e.size})};e.isChatRoom?i("upLoadingSuccess"):h.checkYellow(r).then(function(t){t?i("upLoadingSuccess",e.lang.uploadSuccess):i("forbid",e.lang.checkResult)})}).catch(console.error)}).catch(function(t){e.done((0,i.default)(a,{err:t}))})}},{key:"getUploadImgMsg",value:function(){var t=(new Date).getTime(),e=(0,l.default)("upload_token_live"+this.channelId+t),n={channelId:this.channelId,hash:e,ts:t,bucket:this.bucket};return this.userId&&(n.userId=this.userId),h.ajax({url:"//api.polyv.net/live/upload/token/image/get-token",data:n}).then(function(t){if(!t||"fail"===t.status)return!1;var e=JSON.parse(t.data),n=e.code,r=e.data;return 200===n&&r})}},{key:"sendForIE9",value:function(){var t=(0,c.default)(u.default.mark(function t(e){var n,r,o,i,a,c,s,f=this;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e+".png",this.size||(this.size={width:500,height:500}),this.done({status:"start",msg:this.lang.startUpload,type:"chatImg",id:e,imgSrc:"",size:this.size}),t.next=5,this.getUploadImgMsg();case 5:if(r=t.sent){t.next=8;break}return t.abrupt("return",!1);case 8:o=r.host,i=r.dir,a=r.policy,c=r.accessid,s=r.signature,h.uploadImgForIE9({key:""+i+n,policy:a,OSSAccessKeyId:c,signature:s,success_action_status:"200"},function(){f.done({status:"upLoadingSuccess",msg:f.lang.uploadSuccess,id:e,uploadImgUrl:"http://"+o+"/"+i+n,type:"chatImg",size:f.size})});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"done",value:function(t){var e=this,n=t.status,r=t.id;if("fail"!==n&&"upLoadingFail"!==n&&"forbid"!==n&&"success"!==n||this.files.length-1!==this.currentIndex||(this.file.value=null),"upLoadingFail"===n&&this.imgs[r]){var o=this.imgs[r],i=o.resendTimes,u=o.timeout;if(i!==this.reUploadTimes)return this.imgs[r].resendTimes+=1,void(this.imgs[r].timeout=setTimeout(function(){e.addNewImg(r)},this.reUploadInterval));clearTimeout(u)}else"start"!==n&&this.imgs[r]&&(clearTimeout(this.imgs[r].timeout),delete this.imgs[r]);this.subscriber.forEach(function(e){return e(t)})}},{key:"subscript",value:function(t){this.subscriber.push(t)}},{key:"unSubscript",value:function(t){this.subscriber=this.subscriber.filter(function(e){return e!==t})}},{key:"compressImg",value:function(t,e,n,r){var i=this,u={file:t,fileName:r,quality:n};this.size&&(u.maxWidth=this.maxWidth,u.size=this.size),this.compressImg.num=this.compressImg.num||0,this.compressImg.num++,h.compressImg(u).then(function(t){if(!t)return i.addNewImg(e,!1),void console.warn("å¾çåç¼©å¤±è´¥");if(h.browserType().isIE&&(i.imgs[e].blob=t),i.imgs[e].fileData=t,i.size){var n=i.size.width/i.size.height;i.size.width=i.maxWidth,i.size.height=i.maxWidth/n}i.addNewImg(e,i.compressImg.num<=6)}).catch(function(t){t&&console.log(""+i.lang.compressError+(0,o.default)(t))})}}]),t}(),window&&(window.UpLoadingImgForChat=r),r)},function(t,e,n){var r=n(0),o=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},function(t,e,n){t.exports={default:n(58),__esModule:!0}},function(t,e,n){n(59),t.exports=n(0).Object.assign},function(t,e,n){var r=n(3);r(r.S+r.F,"Object",{assign:n(60)})},function(t,e,n){"use strict";var r=n(12),o=n(29),i=n(20),u=n(30),a=n(38),c=Object.assign;t.exports=!c||n(10)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=r})?function(t,e){for(var n=u(t),c=arguments.length,s=1,f=o.f,l=i.f;c>s;)for(var h,p=a(arguments[s++]),d=f?r(p).concat(f(p)):r(p),v=d.length,g=0;v>g;)l.call(p,h=d[g++])&&(n[h]=p[h]);return n}:c},function(t,e,n){var r=n(11),o=n(39),i=n(62);t.exports=function(t){return function(e,n,u){var a,c=r(e),s=o(c.length),f=i(u,s);if(t&&n!=n){for(;s>f;)if((a=c[f++])!=a)return!0}else for(;s>f;f++)if((t||f in c)&&c[f]===n)return t||f||0;return!t&&-1}}},function(t,e,n){var r=n(25),o=Math.max,i=Math.min;t.exports=function(t,e){return(t=r(t))<0?o(t+e,0):i(t,e)}},function(t,e,n){t.exports=n(64)},function(t,e,n){var r=function(){return this}()||Function("return this")(),o=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,i=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(65),o)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag",s="object"==typeof t,f=e.regeneratorRuntime;if(f)s&&(t.exports=f);else{(f=e.regeneratorRuntime=s?t.exports:{}).wrap=w;var l="suspendedStart",h="suspendedYield",p="executing",d="completed",v={},g={};g[u]=function(){return this};var m=Object.getPrototypeOf,y=m&&m(m(P([])));y&&y!==r&&o.call(y,u)&&(g=y);var b=I.prototype=_.prototype=Object.create(g);S.prototype=b.constructor=I,I.constructor=S,I[c]=S.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===S||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,I):(t.__proto__=I,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(b),t},f.awrap=function(t){return{__await:t}},O(j.prototype),j.prototype[a]=function(){return this},f.AsyncIterator=j,f.async=function(t,e,n,r){var o=new j(w(t,e,n,r));return f.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},O(b),b[c]="Generator",b[u]=function(){return this},b.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=P,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return a.type="throw",a.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],a=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var c=o.call(u,"catchLoc"),s=o.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function w(t,e,n,r){var o=e&&e.prototype instanceof _?e:_,i=Object.create(o.prototype),u=new M(r||[]);return i._invoke=function(t,e,n){var r=l;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return F()}for(n.method=o,n.arg=i;;){var u=n.delegate;if(u){var a=E(u,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=x(t,e,n);if("normal"===c.type){if(r=n.done?d:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}(t,n,u),i}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function _(){}function S(){}function I(){}function O(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function j(t){var e;this._invoke=function(n,r){function i(){return new Promise(function(e,i){!function e(n,r,i,u){var a=x(t[n],t,r);if("throw"!==a.type){var c=a.arg,s=c.value;return s&&"object"==typeof s&&o.call(s,"__await")?Promise.resolve(s.__await).then(function(t){e("next",t,i,u)},function(t){e("throw",t,i,u)}):Promise.resolve(s).then(function(t){c.value=t,i(c)},u)}u(a.arg)}(n,r,e,i)})}return e=e?e.then(i,i):i()}}function E(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,E(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=x(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,v;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return i.next=i}}return{next:F}}function F(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e,n){n(40),n(41),n(46),n(74),n(86),n(87),t.exports=n(0).Promise},function(t,e,n){var r=n(25),o=n(24);t.exports=function(t){return function(e,n){var i,u,a=String(o(e)),c=r(n),s=a.length;return c<0||c>=s?t?"":void 0:(i=a.charCodeAt(c))<55296||i>56319||c+1===s||(u=a.charCodeAt(c+1))<56320||u>57343?t?a.charAt(c):i:t?a.slice(c,c+2):u-56320+(i-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(44),o=n(18),i=n(21),u={};n(7)(u,n(2)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(u,{next:o(1,n)}),i(t,e+" Iterator")}},function(t,e,n){var r=n(4),o=n(5),i=n(12);t.exports=n(6)?Object.defineProperties:function(t,e){o(t);for(var n,u=i(e),a=u.length,c=0;a>c;)r.f(t,n=u[c++],e[n]);return t}},function(t,e,n){var r=n(9),o=n(30),i=n(26)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){"use strict";var r=n(72),o=n(73),i=n(15),u=n(11);t.exports=n(42)(Array,"Array",function(t,e){this._t=u(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r,o,i,u,a=n(14),c=n(1),s=n(16),f=n(47),l=n(3),h=n(8),p=n(17),d=n(75),v=n(76),g=n(48),m=n(49).set,y=n(81)(),b=n(32),w=n(50),x=n(82),_=n(51),S=c.TypeError,I=c.process,O=I&&I.versions,j=O&&O.v8||"",E=c.Promise,L="process"==f(I),T=function(){},M=o=b.f,P=!!function(){try{var t=E.resolve(1),e=(t.constructor={})[n(2)("species")]=function(t){t(T,T)};return(L||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e&&0!==j.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),F=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},k=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var r=t._v,o=1==t._s,i=0,u=function(e){var n,i,u,a=o?e.ok:e.fail,c=e.resolve,s=e.reject,f=e.domain;try{a?(o||(2==t._h&&C(t),t._h=1),!0===a?n=r:(f&&f.enter(),n=a(r),f&&(f.exit(),u=!0)),n===e.promise?s(S("Promise-chain cycle")):(i=F(n))?i.call(n,c,s):c(n)):s(r)}catch(t){f&&!u&&f.exit(),s(t)}};n.length>i;)u(n[i++]);t._c=[],t._n=!1,e&&!t._h&&A(t)})}},A=function(t){m.call(c,function(){var e,n,r,o=t._v,i=N(t);if(i&&(e=w(function(){L?I.emit("unhandledRejection",o,t):(n=c.onunhandledrejection)?n({promise:t,reason:o}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",o)}),t._h=L||N(t)?2:1),t._a=void 0,i&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},C=function(t){m.call(c,function(){var e;L?I.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},z=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),k(e,!0))},U=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(e=F(t))?y(function(){var r={_w:n,_d:!1};try{e.call(t,s(U,r,1),s(z,r,1))}catch(t){z.call(r,t)}}):(n._v=t,n._s=1,k(n,!1))}catch(t){z.call({_w:n,_d:!1},t)}}};P||(E=function(t){d(this,E,"Promise","_h"),p(t),r.call(this);try{t(s(U,this,1),s(z,this,1))}catch(t){z.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(83)(E.prototype,{then:function(t,e){var n=M(g(this,E));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=L?I.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r;this.promise=t,this.resolve=s(U,t,1),this.reject=s(z,t,1)},b.f=M=function(t){return t===E||t===u?new i(t):o(t)}),l(l.G+l.W+l.F*!P,{Promise:E}),n(21)(E,"Promise"),n(84)("Promise"),u=n(0).Promise,l(l.S+l.F*!P,"Promise",{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(a||!P),"Promise",{resolve:function(t){return _(a&&this===u?E:this,t)}}),l(l.S+l.F*!(P&&n(85)(function(t){E.all(t).catch(T)})),"Promise",{all:function(t){var e=this,n=M(e),r=n.resolve,o=n.reject,i=w(function(){var n=[],i=0,u=1;v(t,!1,function(t){var a=i++,c=!1;n.push(void 0),u++,e.resolve(t).then(function(t){c||(c=!0,n[a]=t,--u||r(n))},o)}),--u||r(n)});return i.e&&o(i.v),n.promise},race:function(t){var e=this,n=M(e),r=n.reject,o=w(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(16),o=n(77),i=n(78),u=n(5),a=n(39),c=n(79),s={},f={};(e=t.exports=function(t,e,n,l,h){var p,d,v,g,m=h?function(){return t}:c(t),y=r(n,l,e?2:1),b=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(i(m)){for(p=a(t.length);p>b;b++)if((g=e?y(u(d=t[b])[0],d[1]):y(t[b]))===s||g===f)return g}else for(v=m.call(t);!(d=v.next()).done;)if((g=o(v,y,d.value,e))===s||g===f)return g}).BREAK=s,e.RETURN=f},function(t,e,n){var r=n(5);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(15),o=n(2)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,e,n){var r=n(47),o=n(2)("iterator"),i=n(15);t.exports=n(0).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(1),o=n(49).set,i=r.MutationObserver||r.WebKitMutationObserver,u=r.process,a=r.Promise,c="process"==n(13)(u);t.exports=function(){var t,e,n,s=function(){var r,o;for(c&&(r=u.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(c)n=function(){u.nextTick(s)};else if(!i||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var f=a.resolve(void 0);n=function(){f.then(s)}}else n=function(){o.call(r,s)};else{var l=!0,h=document.createTextNode("");new i(s).observe(h,{characterData:!0}),n=function(){h.data=l=!l}}return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}},function(t,e,n){var r=n(1).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){var r=n(7);t.exports=function(t,e,n){for(var o in e)n&&t[o]?t[o]=e[o]:r(t,o,e[o]);return t}},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(4),u=n(6),a=n(2)("species");t.exports=function(t){var e="function"==typeof o[t]?o[t]:r[t];u&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(2)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i=[7],u=i[r]();u.next=function(){return{done:n=!0}},i[r]=function(){return u},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(3),o=n(0),i=n(1),u=n(48),a=n(51);r(r.P+r.R,"Promise",{finally:function(t){var e=u(this,o.Promise||i.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then(function(){return n})}:t,n?function(n){return a(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(3),o=n(32),i=n(50);r(r.S,"Promise",{try:function(t){var e=o.f(this),n=i(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){"use strict";e.__esModule=!0;var r,o=n(31),i=(r=o)&&r.__esModule?r:{default:r};e.default=function(t){return function(){var e=t.apply(this,arguments);return new i.default(function(t,n){return function r(o,u){try{var a=e[o](u),c=a.value}catch(t){return void n(t)}if(!a.done)return i.default.resolve(c).then(function(t){r("next",t)},function(t){r("throw",t)});t(c)}("next")})}}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var r,o=n(91),i=(r=o)&&r.__esModule?r:{default:r};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){t.exports={default:n(92),__esModule:!0}},function(t,e,n){n(93);var r=n(0).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(3);r(r.S+r.F*!n(6),"Object",{defineProperty:n(4).f})},function(t,e){var n,r;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var o=t[r]<<16|t[r+1]<<8|t[r+2],i=0;i<4;i++)8*r+6*i<=8*t.length?e.push(n.charAt(o>>>6*(3-i)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,o=0;r<t.length;o=++r%4)0!=o&&e.push((n.indexOf(t.charAt(r-1))&Math.pow(2,-2*o+8)-1)<<2*o|n.indexOf(t.charAt(r))>>>6-2*o);return e}},t.exports=r},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(n(97)),o=c(n(35)),i=c(n(110)),u=c(n(31));e.postImgData=function(t){var e=t.data,n=t.imgName,r=t.fileData,o=t.blob,i=e.dir,a=e.policy,c=e.accessid,f=e.signature,l=e.host,h=e.encodedCallback,p=o&&o.size?o:r;return p.size?s({url:"https://"+l+"/",type:"post",data:{key:""+i+n,policy:a,OSSAccessKeyId:c,signature:f,success_action_status:"200",callback:h,file:p}}):u.default.resolve(!1)},e.getLocalImg=function(t){return(window.URL||window.webkitURL).createObjectURL(t)},e.isRightType=function(t){if(!t)return!1;var e=t.match(/[^\/]*$/);return!!e&&-1!==["jpg","jpeg","png","gif"].indexOf(e[0])},e.ajax=s,e.browserType=l,e.addHandler=function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},e.addCompatibleScript=h,e.dataURLtoFile=p,e.getImgSize=function(t){var e=new FileReader,n=new u.default(function(t){e.onload=function(e){var n=e.target.result;if("data:"===n)return t(!1);var r=new Image;r.onload=function(){var e=r.width,n=r.height;t(!(!e||!n)&&{width:e,height:n})},r.onerror=function(){return t(!1)},r.src=n}}).catch(function(t){return alert("è·åå¾çå°ºå¯¸åºéï¼åºéä¿¡æ¯ï¼"+(0,o.default)(t))});return e.readAsDataURL(t),n},e.compressImg=function(t){var e=t.file,n=t.fileName,i=t.size,a=t.width,c=t.quality,s=(window.URL||window.webkitURL).createObjectURL(e),f=function(t){return function(e){return alert("åç¼©å¾çåºé,åºéä¿¡æ¯ï¼"+("object"===(void 0===e?"undefined":(0,r.default)(e))?(0,o.default)(e):e)+",type:"+t)}},l=new Image;return l.src=s,new u.default(function(t){l.onload=function(){var e=this.width,r=this.height,o=e/r;a&&i.width>=a&&(e=a>1?a:a*e),r=e/o;var s=document.createElement("canvas"),d=s.getContext("2d");s.setAttribute("width",e),s.setAttribute("height",r),d.drawImage(this,0,0,e,r);var v=s.toDataURL("image/jpeg",c),g=new u.default(function(t){navigator.userAgent.match(/iphone/i)?h(function(){new MegaPixImage(l).render(s,{maxWidth:e,maxHeight:r,quality:c}),v=s.toDataURL("image/jpeg",c),t()}):t()}).catch(f("ä¿®å¤IOS")),m=new u.default(function(t){navigator.userAgent.match(/Android/i)?h(function(){var n=new JPEGEncoder;v=n.encode(d.getImageData(0,0,e,r),100*c),t()}):t()}).catch(f("ä¿®å¤android"));u.default.all([g,m]).then(function(){t(p(v,n))}).catch(f("çæç»æ"))}}).catch(f("out"))},e.checkYellow=function(t){var e=(new Date).getTime(),n=(0,a.default)("polyv_chat_api_innortimestamp"+e+"url"+t+"polyv_chat_api_innor").toLocaleUpperCase();return s({url:location.protocol+"//api.polyv.net/live/inner/v3/chat/image/porn-identify",type:"post",data:{sign:n,timestamp:e,url:t}}).then(function(t){if(t&&200===t.code){var e=JSON.parse(t.data).data;return e}}).catch(console.error)},e.uploadImgForIE9Init=d,e.uploadImgForIE9=function(t,e){var n=d.$form,o=d.$subInput;if(!n)return;null!==t&&"object"===(void 0===t?"undefined":(0,r.default)(t))&&(0,i.default)(t).forEach(function(e){var r=t[e];v(function(t,e){var n=document.createElement("input");return n.setAttribute("type","hidden"),n.setAttribute("name",t),n.setAttribute("value",e),n}(e,r),n)});o.click(),e instanceof Function&&e()},e.prepend=v;var a=c(n(52));function c(t){return t&&t.__esModule?t:{default:t}}function s(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.url,c=n.data,s=void 0===c?null:c,f=n.type,l=void 0===f?"get":f,h=new XMLHttpRequest;if("get"===(l=l.toLocaleLowerCase()))t=a,a=(e=s)?((0,i.default)(e).forEach(function(n){var r=-1===t.indexOf("?")?"?":"&",i=e[n];i instanceof Object&&(i=(0,o.default)(i)),t+=""+r+encodeURIComponent(n)+"="+encodeURIComponent(i)}),t):t,s=null;else{var p=new FormData;"object"===(void 0===s?"undefined":(0,r.default)(s))&&(0,i.default)(s).forEach(function(t){p.append(t,s[t])}),s=p}return new u.default(function(t,e){h.onreadystatechange=function(){4===h.readyState&&(h.status>=200&&h.status<300||304===h.status?t({status:!0,code:h.status,data:h.responseText}):e(new Error({status:!1,code:h.status})))},h.open(l,a,!0),h.send(s)}).catch(function(t){return console.warn("åéå¾çåºéï¼æ¥å£ä¿¡æ¯ï¼"+a)})}var f=function(){var t=navigator.userAgent,e=t.indexOf("Opera")>-1,n=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!e||t.match("Edge");new RegExp("MSIE (\\d+\\.\\d+);").test(t);var r=parseFloat(RegExp.$1),o=void 0;try{o=t.match(/rv:\d+\.\d+/)[0].match(/\d+\.\d+/)[0]}catch(t){}var i={isIE:n||o,version:o?"11":r};return f=function(){return i},i};function l(){return f()}function h(t){var e=document.getElementsByTagName("script"),n=!!e.length,r=n?e[0].parentNode:document.body,o=document.createElement("script"),i=location.href.match("https")?"https":"http";o.setAttribute("src",i+"://live.polyv.cn/assets/wjs/dist/mobileBUGFix.mini.js"),o.setAttribute("type","text/javascript"),o.onload=function(){t instanceof Function&&t()},n&&r.insertBefore(o,e[0])}function p(t,e){try{for(var n=t.split(","),r=n[0].match(/:(.*?);/),o=r?r[1]:"image/jpeg",i=window.atob(n[1]),u=i.length,a=new Uint8Array(u);u--;)a[u]=i.charCodeAt(u);return l().isIE?new Blob([a],{type:o}):new File([a],e,{type:o})}catch(t){return!1}}function d(t){if(t="string"==typeof t?document.querySelector(t):t){var e=t.parentNode,n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("action","https://liveimages.videocc.net/"),n.setAttribute("enctype","multipart/form-data"),e.appendChild(n),d.$form=n,n.appendChild(t);var r=document.createElement("input");r.setAttribute("type","submit"),r.setAttribute("style","display:none;"),n.appendChild(r),d.$subInput=r}}function v(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.append(t)}},function(t,e,n){"use strict";e.__esModule=!0;var r=u(n(98)),o=u(n(100)),i="function"==typeof o.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":typeof t};function u(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof o.default&&"symbol"===i(r.default)?function(t){return void 0===t?"undefined":i(t)}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":void 0===t?"undefined":i(t)}},function(t,e,n){t.exports={default:n(99),__esModule:!0}},function(t,e,n){n(41),n(46),t.exports=n(33).f("iterator")},function(t,e,n){t.exports={default:n(101),__esModule:!0}},function(t,e,n){n(102),n(40),n(108),n(109),t.exports=n(0).Symbol},function(t,e,n){"use strict";var r=n(1),o=n(9),i=n(6),u=n(3),a=n(43),c=n(103).KEY,s=n(10),f=n(27),l=n(21),h=n(19),p=n(2),d=n(33),v=n(34),g=n(104),m=n(105),y=n(5),b=n(8),w=n(11),x=n(23),_=n(18),S=n(44),I=n(106),O=n(107),j=n(4),E=n(12),L=O.f,T=j.f,M=I.f,P=r.Symbol,F=r.JSON,k=F&&F.stringify,A=p("_hidden"),N=p("toPrimitive"),C={}.propertyIsEnumerable,z=f("symbol-registry"),U=f("symbols"),R=f("op-symbols"),D=Object.prototype,B="function"==typeof P,W=r.QObject,G=!W||!W.prototype||!W.prototype.findChild,H=i&&s(function(){return 7!=S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=L(D,e);r&&delete D[e],T(t,e,n),r&&t!==D&&T(D,e,r)}:T,J=function(t){var e=U[t]=S(P.prototype);return e._k=t,e},q=B&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},V=function(t,e,n){return t===D&&V(R,e,n),y(t),e=x(e,!0),y(n),o(U,e)?(n.enumerable?(o(t,A)&&t[A][e]&&(t[A][e]=!1),n=S(n,{enumerable:_(0,!1)})):(o(t,A)||T(t,A,_(1,{})),t[A][e]=!0),H(t,e,n)):T(t,e,n)},Y=function(t,e){y(t);for(var n,r=g(e=w(e)),o=0,i=r.length;i>o;)V(t,n=r[o++],e[n]);return t},K=function(t){var e=C.call(this,t=x(t,!0));return!(this===D&&o(U,t)&&!o(R,t))&&(!(e||!o(this,t)||!o(U,t)||o(this,A)&&this[A][t])||e)},Q=function(t,e){if(t=w(t),e=x(e,!0),t!==D||!o(U,e)||o(R,e)){var n=L(t,e);return!n||!o(U,e)||o(t,A)&&t[A][e]||(n.enumerable=!0),n}},X=function(t){for(var e,n=M(w(t)),r=[],i=0;n.length>i;)o(U,e=n[i++])||e==A||e==c||r.push(e);return r},Z=function(t){for(var e,n=t===D,r=M(n?R:w(t)),i=[],u=0;r.length>u;)!o(U,e=r[u++])||n&&!o(D,e)||i.push(U[e]);return i};B||(a((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(n){this===D&&e.call(R,n),o(this,A)&&o(this[A],t)&&(this[A][t]=!1),H(this,t,_(1,n))};return i&&G&&H(D,t,{configurable:!0,set:e}),J(t)}).prototype,"toString",function(){return this._k}),O.f=Q,j.f=V,n(54).f=I.f=X,n(20).f=K,n(29).f=Z,i&&!n(14)&&a(D,"propertyIsEnumerable",K,!0),d.f=function(t){return J(p(t))}),u(u.G+u.W+u.F*!B,{Symbol:P});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;$.length>tt;)p($[tt++]);for(var et=E(p.store),nt=0;et.length>nt;)v(et[nt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return o(z,t+="")?z[t]:z[t]=P(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),u(u.S+u.F*!B,"Object",{create:function(t,e){return void 0===e?S(t):Y(S(t),e)},defineProperty:V,defineProperties:Y,getOwnPropertyDescriptor:Q,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),F&&u(u.S+u.F*(!B||s(function(){var t=P();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(b(e)||void 0!==t)&&!q(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!q(e))return e}),r[1]=e,k.apply(F,r)}}),P.prototype[N]||n(7)(P.prototype,N,P.prototype.valueOf),l(P,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,e,n){var r=n(19)("meta"),o=n(8),i=n(9),u=n(4).f,a=0,c=Object.isExtensible||function(){return!0},s=!n(10)(function(){return c(Object.preventExtensions({}))}),f=function(t){u(t,r,{value:{i:"O"+ ++a,w:{}}})},l=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!e)return"E";f(t)}return t[r].i},getWeak:function(t,e){if(!i(t,r)){if(!c(t))return!0;if(!e)return!1;f(t)}return t[r].w},onFreeze:function(t){return s&&l.NEED&&c(t)&&!i(t,r)&&f(t),t}}},function(t,e,n){var r=n(12),o=n(29),i=n(20);t.exports=function(t){var e=r(t),n=o.f;if(n)for(var u,a=n(t),c=i.f,s=0;a.length>s;)c.call(t,u=a[s++])&&e.push(u);return e}},function(t,e,n){var r=n(13);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(11),o=n(54).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(t){return u.slice()}}(t):o(r(t))}},function(t,e,n){var r=n(20),o=n(18),i=n(11),u=n(23),a=n(9),c=n(36),s=Object.getOwnPropertyDescriptor;e.f=n(6)?s:function(t,e){if(t=i(t),e=u(e,!0),c)try{return s(t,e)}catch(t){}if(a(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,n){n(34)("asyncIterator")},function(t,e,n){n(34)("observable")},function(t,e,n){t.exports={default:n(111),__esModule:!0}},function(t,e,n){n(112),t.exports=n(0).Object.keys},function(t,e,n){var r=n(30),o=n(12);n(113)("keys",function(){return function(t){return o(r(t))}})},function(t,e,n){var r=n(3),o=n(0),i=n(10);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],u={};u[t]=e(n),r(r.S+r.F*i(function(){n(1)}),"Object",u)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={en:{missingId:"Missing id",invalidImage:"Invalid image",inCorrectFormat:"The image format is incorrect and must be jpg, jpeg, png, gif.",tooLarge:"The image is too large, please select an image smaller than 2M.",startUpload:"Start upload",uploadFail:"Upload failed",uploadSuccess:"Upload success",compressError:"An error occurred while compressing the image:",checkResult:"Yellowing failure",beyondSize:"Through the long"},zh_CN:{missingId:"ç¼ºå°ä¸ä¼ å¾çinputçid",invalidImage:"å¾çåºéï¼ä¸ºæ æå¾ç",inCorrectFormat:"å¾çæ ¼å¼ä¸æ­£ç¡®ï¼å¿é¡»ä¸ºjpgï¼jpegï¼pngï¼gifã",tooLarge:"å¾çè¿å¤§ï¼è¯·éæ©å°äº2Mçå¾çã",startUpload:"å¼å§ä¸ä¼ ",uploadFail:"ä¸ä¼ å¤±è´¥",uploadSuccess:"ä¸ä¼ å¾çæå",compressError:"åç¼©å¾çæ¶åºéï¼åºéä¿¡æ¯ä¸ºï¼",checkResult:"é´é»å¤±è´¥",beyondSize:"å¾çè¿é¿"}}}]);